#!/usr/bin/env bash
set -euo pipefail

echo "[pre-commit] Running tests (all projects)..."
npx nx run-many -t test --projects=stats-models,stats-data-access,api --skip-nx-cache

echo "[pre-commit] Running web tests with coverage..."
npx nx run web:test --skip-nx-cache --codeCoverage

echo "[pre-commit] Recording coverage snapshot..."
node scripts/record-coverage.mjs
